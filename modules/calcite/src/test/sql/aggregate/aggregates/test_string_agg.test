# name: test/sql/aggregate/aggregates/test_string_agg.test
# description: Test STRING_AGG operator
# group: [aggregates]

# test incorrect usage of STRING_AGG function

# Tests ordering, distincts, etc.
statement ok
CREATE TABLE IF NOT EXISTS trades (id INTEGER,amount INTEGER, xkey VARCHAR(255), name VARCHAR(255),ts TIMESTAMP, PRIMARY KEY(id));

statement ok
INSERT INTO trades(id, amount, xkey, name, ts) VALUES (5, 1000, 'key-4', 'name3', '2021-09-01 17:00:00'), (6, 200,  'key-2', 'name11','2021-12-01 18:00:00');

# Simple ordering
query T
SELECT 'x' || name || 'x' FROM trades
----
'xname3x'
'xname11x'

